<!DOCTYPE html>
<html lang="en"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout.html">
<div layout:fragment="content">
    <div class="row mt-3">
        <div class="col-12 mx-auto">
            <div class="row mx-auto">
                <div class="col-md-5 mx-auto my-auto">
                    <div id="carouselExample" class="carousel slide" style="width: 500px">
                        <div class="carousel-inner mx-auto">
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample"
                                data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"
                                  style="background-color: rgba(187,253,220,0.69)"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExample"
                                data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"
                                  style="background-color: rgba(187,253,220,0.69)"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
                <div class="col-md-4 mx-auto my-auto">
                    <div class="row">
                        <p><em id="subTypeId"></em></p>
                    </div>
                    <div class="row">
                        <h1 id="modelName" class="h4"></h1>
                    </div>
                    <div class="row ">
                        <p>Article: <small id="article"></small></p>
                    </div>
                    <div class="row mt-2 p-3" style="background-color: rgba(187,253,220,0.21)">
                        <div class="row mx-auto">
                            <p class="display-5 fw-bolder text-center" id="price"
                               style="color: rgba(250,0,39,0.74)"></p>
                        </div>
                        <div class="row mx-auto">
                            <button class="btn btn-success w-100">Add to cart</button>
                        </div>
                        <div class="row mt-1 mb-1 mx-auto">
                            <button class="btn btn-outline-success w-100">Take from shop</button>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="row d-inline-flex">
                            <div class="col-md-8">
                                <p class="text-black-50 small">DELIVERY to HOME</p>
                            </div>
                            <div class="col-md-4 text-center">
                                <p class="fw-bolder" style="color: rgba(0,133,69,0.8)">20$</p>
                            </div>
                        </div>
                        <div class="row d-inline-flex">
                            <div class="col-md-8">
                                <p class="text-black-50 small">DELIVERY to HOME FAST</p>
                            </div>
                            <div class="col-md-4 text-center">
                                <p class="fw-bolder" style="color: rgba(0,133,69,0.8)">30$</p>
                            </div>
                        </div>
                        <div class="row d-inline-flex">
                            <div class="col-md-8">
                                <p class="text-black-50 small">DELIVERY to KAZPOST</p>
                            </div>
                            <div class="col-md-4 text-center">
                                <p class="fw-bolder" style="color: rgba(0,133,69,0.8)">15$</p>
                            </div>
                        </div>
                        <div class="row d-inline-flex">
                            <div class="col-md-8">
                                <p class="text-black-50 small">TAKE OUT FROM SHOP</p>
                            </div>
                            <div class="col-md-4 text-center">
                                <p class="fw-bolder" style="color: rgba(0,133,69,0.8)">Free</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-10">
                    <div class="row mt-3 ">
                        <div class="col-md-10 ms-0">
                            <p class="h4">Description</p>
                        </div>
                    </div>
                    <div class="row mt-2 ">
                        <div class="col-md-10 ms-0">
                            <p class="lh-sm" id="content"></p>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-8 ms-0">
                            <p class="h4">Details</p>
                        </div>
                    </div>
                    <div class="row mt-2 text-black-50">
                        <div class="col-md-5">
                                <p class="d-inline-block">Brand:</p>
                                <a class="d-inline-block float-end text-decoration-none" href="#" id="brand"
                                   style="color: rgba(0,133,69,0.8)"></a>
                                <hr>
                        </div>
                        <div class="col-md-5">
                            <p class="d-inline-block">Collection:</p>
                            <p class="d-inline-block float-end" id="collection"></p>
                            <hr>
                        </div>
                        <div class="col-md-5 ms-0">
                            <p class="d-inline-block">Gender:</p>
                            <p class="d-inline-block float-end" id="gender"></p>
                            <hr>
                        </div>
                        <div class="col-md-5 ms-0">
                            <p class="d-inline-block">Materials:</p>
                            <p class="d-inline-block float-end" id="materials"></p>
                            <hr>
                        </div>
                    </div>
                    <div class="row mt-2 text-black-50">
                        <div class="col-md-5 ms-0">
                            <p class="d-inline-block">Model Name:</p>
                            <p class="d-inline-block float-end" id="modelNameDetails"></p>
                            <hr>
                        </div>
                        <div class="col-md-5 ms-0">
                            <p class="d-inline-block">Sub Type:</p>
                            <p class="d-inline-block float-end" id="subType"></p>
                            <hr>
                        </div>
                        <div class="col-md-5 ms-0">
                            <p class="d-inline-block">Colors:</p>
                            <p class="d-inline-block float-end" id="colors"></p>
                            <hr>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            const path = window.location.pathname;
            const pathParts = path.split('/');
            const itemId = pathParts[3];
            fetch('http://localhost:8000/api/item/' + itemId)
                .then(response => response.json())
                .then(item => {
                    if (item != null) {
                        const {
                            id,
                            modelName,
                            price,
                            collection,
                            subType,
                            gender,
                            materials,
                            colors,
                            isChild,
                            discount,
                            pictures,
                            content,
                            article
                        } = item;
                        document.getElementById("modelName").innerText = modelName;
                        document.getElementById("modelNameDetails").innerText = modelName;
                        document.getElementById("price").innerText = price + ' $';
                        // document.getElementById("isChild").checked = isChild;
                        document.getElementById("subTypeId").innerText = subType.type.name + ' â†’ ' + subType.name;
                        document.getElementById("subType").innerText = subType.type.name;
                        document.getElementById("article").innerText = article;
                        document.getElementById("content").innerText = content;
                        document.getElementById("brand").innerText = collection.brand.name;
                        document.getElementById("gender").innerText = gender.name;
                        document.getElementById("collection").innerText = collection.name;

                        materials.forEach(material => {
                            document.getElementById("materials").innerText += material.name + ' ';
                        });
                        colors.forEach(color => {
                            document.getElementById("colors").innerText += color.name + ' ';
                        })
                        const carouselInner = document.querySelector('#carouselExample .carousel-inner')
                        if (pictures != null) {
                            pictures.forEach((picture, index) => {
                                const div = document.createElement('div');
                                div.classList.add('carousel-item');
                                if (index === 0) {
                                    div.classList.add('active');
                                }
                                const img = document.createElement('img');
                                img.classList.add('d-block', 'w-100');
                                img.src = "http://localhost:8000/file/view/" + picture.name;
                                div.appendChild(img);
                                carouselInner.appendChild(div);
                            });
                        }
                    } else {
                    }
                }).catch(error => {
                console.error(error);
            });

            function showAlert(message, isError) {
                var alertDiv = document.createElement("div");
                isError ?
                    alertDiv.className = "alert alert-danger col-6 mx-auto fixed-top"
                    :
                    alertDiv.className = "alert alert-success col-6 mx-auto fixed-top";
                alertDiv.innerHTML = message;
                document.body.appendChild(alertDiv);

                setTimeout(function () {
                    alertDiv.remove();
                }, 3000);
            }
        </script>
    </div>
</div>
</html>